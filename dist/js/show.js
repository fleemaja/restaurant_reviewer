function initMap(a,e){var t={lat:a,lng:e},i=new google.maps.Map(document.getElementById("map"),{zoom:17,center:t,draggable:!1,scrollwheel:!1,panControl:!1});new google.maps.Marker({position:t,map:i});google.maps.event.addListener(i,"tilesloaded",function(){[].slice.apply(document.querySelectorAll("#map a")).forEach(function(a){a.setAttribute("tabindex","-1")})})}function addNewReview(){var a=$("#name-input").val(),e=getDate(),t=$("#stars").val(),i=$("#review-input").val(),s="";s+="<hr><div class='review'><p><strong>"+a+"</strong>",s+="<span class='review-date'>"+e+"</span></p>",s+="<p>"+"<i class='fa fa-star' aria-hidden='true'></i>".repeat(t)+"<i class='fa fa-star-o' aria-hidden='true'></i>".repeat(5-t),s+="<span class='sr-only'>Rating: "+t+" out of 5 stars</span></p>",s+="<p>"+i+"</p></div>",$(".reviews").prepend(s),$("html, body").stop(!0,!0).animate({scrollTop:$(".reviews").offset().top-90},500);var r={name:a,date:e,rating:parseInt(t),comments:i};reviews[document.title].unshift(r),localStorage._restaurantReviews=JSON.stringify(reviews),$("#name-input").val(""),$("#review-input").val("")}function getDate(){var a=new Date,e=a.getMonth(),t=a.getDate(),i=a.getFullYear();return months[e]+" "+t+", "+i}function isStarValid(){var a=$("#stars").val();return""!==a}function isNameValid(){var a=$("#name-input").val();return""!==a}function isReviewValid(){var a=$("#review-input").val();return""!==a}var restaurants,reviews,nameTooltip=$("#name-tooltip"),starTooltip=$("#star-tooltip"),reviewTooltip=$("#review-tooltip");$("form").submit(function(a){a.preventDefault();var e=!0;isStarValid()||(e=!1,starTooltip.css("opacity",1)),isNameValid()||(e=!1,nameTooltip.css("opacity",1)),isReviewValid()||(e=!1,reviewTooltip.css("opacity",1)),e&&addNewReview()});var months=["January","February","March","April","May","June","July","August","September","October","November","December"];$("#stars").on("starrr:change",function(a,e){$("#stars").val(e),starTooltip.css("opacity",0)}),$("#name-input").focusout(function(){isNameValid()||nameTooltip.css("opacity",1)}),$("#name-input").focusin(function(){nameTooltip.css("opacity",0)}),$("#review-input").focusout(function(){isReviewValid()||reviewTooltip.css("opacity",1)}),$("#review-input").focusin(function(){reviewTooltip.css("opacity",0)}),$("#stars").on("keydown",function(a){var e=0;$("#stars > i").each(function(){"true"==$(this).attr("aria-checked")&&(e=parseInt($(this).attr("id").split("-")[1]))}),39==a.which?e<5&&(e+=1,$("#star-"+e).click()):37==a.which&&e>0&&(e-=1,$("#star-"+e).click())}),$(document).ready(function(){$.ajax({url:"https://fleemaja.github.io/restaurant_reviewer/data/restaurants.json",type:"GET",success:function(a){restaurants=a,$.ajax({url:"https://fleemaja.github.io/restaurant_reviewer/data/reviews.json",type:"GET",success:function(a){reviews=JSON.parse(localStorage.getItem("_restaurantReviews"))||a;var e=window.location.href,t=e.split("?r="),i=t[1];i=i.replace(/%27/g,"'").replace(/%20/g," ");var s=!1;$.each(restaurants,function(a,e){if(e.name===i){initMap(e.latlng.lat,e.latlng.lng),s=!0;var t="";t+="<figure><h1>"+e.name+"</h1>",t+="<img class='img-fluid' src='./assets/images/"+e.photograph+"' alt='' >",t+="<figcaption><p><i class='fa fa-map-marker' aria-hidden='true' title='Address'></i><span class='sr-only'>Address:</span> "+e.address.split("$")[0]+"</p>",t+="<p><i class='fa fa-map-marker' aria-hidden='true' title='Address'></i> "+e.address.split("$")[1]+"</p>",t+="<p><i class='fa fa-cutlery' aria-hidden='true' title='Cuisine Type'></i><span class='sr-only'>Cuisine Type:</span> "+e.cuisine_type+"</p><hr>",t+="<p><i class='fa fa-clock-o' aria-hidden='true' title='Business Hours'></i><span class='sr-only'>Business Hours:</span></p><table>",$.each(Object.keys(e.operating_hours),function(a,i){t+="<tr><td><strong>"+i+"</strong></td><td>"+e.operating_hours[i].replace(",","<br>")+"</td></tr>"}),t+="</table></figcaption></figure>",$(".info").prepend(t);var r="";$.each(reviews[i],function(a,e){r+="<hr><div class='review'><p><strong>"+e.name+"</strong>",r+="<span class='review-date'>"+e.date+"</span></p>",r+="<p>"+"<i class='fa fa-star' aria-hidden='true'></i>".repeat(e.rating)+"<i class='fa fa-star-o' aria-hidden='true'></i>".repeat(5-e.rating),r+="<span class='sr-only'>Rating: "+e.rating+" out of 5 stars</span></p>",r+="<p>"+e.comments+"</p></div>"}),$(".reviews").html(r),document.title=i}}),s||(html="404",document.title="404",$(".container").append(html))}})}})});