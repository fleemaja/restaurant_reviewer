function initMap(a,t){var e={lat:a,lng:t},i=new google.maps.Map(document.getElementById("map"),{zoom:17,center:e,draggable:!1,scrollwheel:!1,panControl:!1,disableDefaultUI:!0});new google.maps.Marker({position:e,map:i});google.maps.event.addListener(i,"tilesloaded",function(){[].slice.apply(document.querySelectorAll("#map a")).forEach(function(a){a.setAttribute("tabindex","-1")})})}function multiplyString(a,t){for(var e="",i=1;i<=t;i++)e+=a;return e}function addNewReview(){var a=$("#name-input").val(),t=getDate(),e=$("#stars").val(),i=$("#review-input").val(),s="";s+="<hr><article class='review'><p><strong>"+a+"</strong>",s+="<span class='review-date'>"+t+"</span></p>",s+="<p>"+multiplyString("<i class='fa fa-star' aria-hidden='true'></i>",e)+multiplyString("<i class='fa fa-star-o' aria-hidden='true'></i>",5-e),s+="<span class='sr-only'>Rating: "+e+" out of 5 stars</span></p>",s+="<p>"+i+"</p></article>",$(".reviews").prepend(s),$("html, body").stop(!0,!0).animate({scrollTop:$(".reviews").offset().top-90},500);var r={name:a,date:t,rating:parseInt(e),comments:i};reviews[document.title].unshift(r),localStorage._restaurantReviews=JSON.stringify(reviews),$("#name-input").val(""),$("#review-input").val("")}function getDate(){var a=new Date,t=a.getMonth(),e=a.getDate(),i=a.getFullYear();return months[t]+" "+e+", "+i}function isStarValid(){var a=$("#stars").val();return""!==a}function isNameValid(){var a=$("#name-input").val();return""!==a}function isReviewValid(){var a=$("#review-input").val();return""!==a}var restaurants,reviews,nameTooltip=$("#name-tooltip"),starTooltip=$("#star-tooltip"),reviewTooltip=$("#review-tooltip");$("form").submit(function(a){a.preventDefault();var t=!0;isStarValid()||(t=!1,starTooltip.css("opacity",1)),isNameValid()||(t=!1,nameTooltip.css("opacity",1)),isReviewValid()||(t=!1,reviewTooltip.css("opacity",1)),t&&addNewReview()});var months=["January","February","March","April","May","June","July","August","September","October","November","December"];$("#stars").on("starrr:change",function(a,t){$("#stars").val(t),starTooltip.css("opacity",0)}),$("#name-input").focusout(function(){isNameValid()||nameTooltip.css("opacity",1)}),$("#name-input").focusin(function(){nameTooltip.css("opacity",0)}),$("#review-input").focusout(function(){isReviewValid()||reviewTooltip.css("opacity",1)}),$("#review-input").focusin(function(){reviewTooltip.css("opacity",0)}),$("#stars").on("keydown",function(a){var t=0;$("#stars > i").each(function(){"true"==$(this).attr("aria-checked")&&(t=parseInt($(this).attr("id").split("-")[1]))}),39==a.which?t<5&&(t+=1,$("#star-"+t).click()):37==a.which&&t>0&&(t-=1,$("#star-"+t).click())}),$(document).ready(function(){$.ajax({url:"https://fleemaja.github.io/restaurant_reviewer/data/restaurants.json",type:"GET",success:function(a){restaurants=a,$.ajax({url:"https://fleemaja.github.io/restaurant_reviewer/data/reviews.json",type:"GET",success:function(a){reviews=JSON.parse(localStorage.getItem("_restaurantReviews"))||a;var t=window.location.href,e=t.split("?r="),i=e[1];i=i.replace(/%27/g,"'").replace(/%20/g," ");var s=!1;$.each(restaurants,function(a,t){if(t.name===i){initMap(t.latlng.lat,t.latlng.lng),s=!0;var e="";e+="<article class='restaurant'><h1>"+t.name+"</h1>",e+="<img class='img-fluid' src='./assets/images/"+t.photograph+"' alt='' >",e+="<div class='restaurant-info'><p><i class='fa fa-map-marker' aria-hidden='true' title='Address'></i><span class='sr-only'>Address:</span> "+t.address.split("$")[0]+"</p>",e+="<p><i class='fa fa-map-marker' aria-hidden='true' title='Address'></i> "+t.address.split("$")[1]+"</p>",e+="<p><i class='fa fa-cutlery' aria-hidden='true' title='Cuisine Type'></i><span class='sr-only'>Cuisine Type:</span> "+t.cuisine_type+"</p><hr>",e+="<p><i class='fa fa-clock-o' aria-hidden='true' title='Business Hours'></i><span class='sr-only'>Business Hours:</span></p><table>",$.each(Object.keys(t.operating_hours),function(a,i){e+="<tr><td><strong>"+i+"</strong></td><td>"+t.operating_hours[i].replace(",","<br>")+"</td></tr>"}),e+="</table></div></article>",$(".info").prepend(e);var r="";$.each(reviews[i],function(a,t){r+="<hr><article class='review'><p><strong>"+t.name+"</strong>",r+="<span class='review-date'>"+t.date+"</span></p>",r+="<p>"+multiplyString("<i class='fa fa-star' aria-hidden='true'></i>",t.rating)+multiplyString("<i class='fa fa-star-o' aria-hidden='true'></i>",5-t.rating),r+="<span class='sr-only'>Rating: "+t.rating+" out of 5 stars</span></p>",r+="<p>"+t.comments+"</p></article>"}),$(".reviews").html(r),document.title=i}}),s||(html="404",document.title="404",$(".container").append(html))}})}})});