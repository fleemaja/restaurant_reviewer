function initMap(e,a){var t={lat:e,lng:a},i=new google.maps.Map(document.getElementById("map"),{zoom:17,center:t,draggable:!1,scrollwheel:!1,panControl:!1});new google.maps.Marker({position:t,map:i});google.maps.event.addListener(i,"tilesloaded",function(){[].slice.apply(document.querySelectorAll("#map a")).forEach(function(e){e.setAttribute("tabindex","-1")})})}function addNewReview(){var e=$("#name-input").val(),a=getDate(),t=$("#stars").val(),i=$("#review-input").val(),s="";s+="<hr><div class='review'><p><strong>"+e+"</strong>",s+="<span class='review-date'>"+a+"</span></p>",s+="<p>"+"<i class='fa fa-star' aria-hidden='true'></i>".repeat(t)+"<i class='fa fa-star-o' aria-hidden='true'></i>".repeat(5-t),s+="<span class='sr-only'>Rating: "+t+" out of 5 stars</span></p>",s+="<p>"+i+"</p></div>",$(".reviews").prepend(s),$("html, body").stop(!0,!0).animate({scrollTop:$(".reviews").offset().top-90},500);var r={name:e,date:a,rating:parseInt(t),comments:i};reviews[document.title].unshift(r),localStorage._restaurantReviews=JSON.stringify(reviews),$("#name-input").val(""),$("#review-input").val("")}function getDate(){var e=new Date,a=e.getMonth(),t=e.getDate(),i=e.getFullYear();return months[a]+" "+t+", "+i}function isStarValid(){var e=$("#stars").val();return""!==e}function isNameValid(){var e=$("#name-input").val();return""!==e}function isReviewValid(){var e=$("#review-input").val();return""!==e}var restaurants,reviews,nameTooltip=$("#name-tooltip"),starTooltip=$("#star-tooltip"),reviewTooltip=$("#review-tooltip");$("form").submit(function(e){e.preventDefault();var a=!0;isStarValid()||(a=!1,starTooltip.css("opacity",1)),isNameValid()||(a=!1,nameTooltip.css("opacity",1)),isReviewValid()||(a=!1,reviewTooltip.css("opacity",1)),a&&addNewReview()});var months=["January","February","March","April","May","June","July","August","September","October","November","December"];$("#stars").on("starrr:change",function(e,a){$("#stars").val(a),starTooltip.css("opacity",0)}),$("#name-input").focusout(function(){isNameValid()||nameTooltip.css("opacity",1)}),$("#name-input").focusin(function(){nameTooltip.css("opacity",0)}),$("#review-input").focusout(function(){isReviewValid()||reviewTooltip.css("opacity",1)}),$("#review-input").focusin(function(){reviewTooltip.css("opacity",0)}),$(document).ready(function(){$.ajax({url:"https://fleemaja.github.io/restaurant_reviewer/data/restaurants.json",type:"GET",success:function(e){restaurants=e,$.ajax({url:"https://fleemaja.github.io/restaurant_reviewer/data/reviews.json",type:"GET",success:function(e){reviews=JSON.parse(localStorage.getItem("_restaurantReviews"))||e;var a=window.location.href,t=a.split("?r="),i=t[1];i=i.replace(/%27/g,"'").replace(/%20/g," ");var s=!1;$.each(restaurants,function(e,a){if(a.name===i){initMap(a.latlng.lat,a.latlng.lng),s=!0;var t="";t+="<figure><h1>"+a.name+"</h1>",t+="<img class='img-fluid' src='./assets/images/"+a.photograph+"' alt='' >",t+="<figcaption><p><i class='fa fa-map-marker' aria-hidden='true' title='Address'></i><span class='sr-only'>Address:</span> "+a.address.split("$")[0]+"</p>",t+="<p><i class='fa fa-map-marker' aria-hidden='true' title='Address'></i> "+a.address.split("$")[1]+"</p>",t+="<p><i class='fa fa-cutlery' aria-hidden='true' title='Cuisine Type'></i><span class='sr-only'>Cuisine Type:</span> "+a.cuisine_type+"</p><hr>",t+="<p><i class='fa fa-clock-o' aria-hidden='true' title='Business Hours'></i><span class='sr-only'>Business Hours:</span></p><table>",$.each(Object.keys(a.operating_hours),function(e,i){t+="<tr><td><strong>"+i+"</strong></td><td>"+a.operating_hours[i].replace(",","<br>")+"</td></tr>"}),t+="</table></figcaption></figure>",$(".info").prepend(t);var r="";$.each(reviews[i],function(e,a){r+="<hr><div class='review'><p><strong>"+a.name+"</strong>",r+="<span class='review-date'>"+a.date+"</span></p>",r+="<p>"+"<i class='fa fa-star' aria-hidden='true'></i>".repeat(a.rating)+"<i class='fa fa-star-o' aria-hidden='true'></i>".repeat(5-a.rating),r+="<span class='sr-only'>Rating: "+a.rating+" out of 5 stars</span></p>",r+="<p>"+a.comments+"</p></div>"}),$(".reviews").html(r),document.title=i}}),s||(html="404",document.title="404",$(".container").append(html))}})}})});